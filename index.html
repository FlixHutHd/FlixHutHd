<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FlixHutHD - Standard Dark Theme</title>
<link rel="icon" type="image/png" href="flixhuthd.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #121212;
      --bg-secondary: #1E1E1E;
      --bg-tertiary: #282828;
      --text-primary: #E0E0E0;
      --text-secondary: #BDBDBD;
      --accent-primary: #3498DB;
      --accent-secondary: #F39C12;
      --border-color: #333333;
      --card-shadow: rgba(0, 0, 0, 0.2);
      --button-hover-primary: #2980B9;
      --download-link-color: #00A9FF;
      --download-section-title-color: #FF484F;
      --base-font-size: 16px;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
      font-size: var(--base-font-size);
    }
    body.modal-open, body.category-menu-open {
        overflow: hidden;
    }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg-secondary); }
    ::-webkit-scrollbar-thumb { background: var(--accent-primary); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--button-hover-primary); }

    a { text-decoration: none; color: var(--accent-primary); transition: color 0.2s ease; }
    a:hover { color: var(--accent-secondary); text-decoration: none !IMPORTANT; }

    .container { width: 95%; max-width: 1400px; margin: 0 auto; padding: 0 15px; }

    header.primary-header { background-color: var(--bg-secondary); border-bottom: 1px solid var(--border-color); box-shadow: 0 1px 4px rgba(0,0,0,0.1); position: relative; z-index: 1002; }
    .primary-header .navbar-default {
        padding: 5px 0;
        margin-bottom: 0;
    }
    .primary-header .navbar-default .container {
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
    }
    .primary-header .navbar-header { padding: 3px 0; }
    .primary-header .navbar-brand img.site-logo {
        height: 50px;
        width: auto;
        vertical-align: middle;
    }
    .site-title-text {
        font-size: 2em;
        font-weight: 700;
        color: var(--accent-primary);
        font-family: 'Rajdhani', sans-serif;
    }

    .carousel-slider-container {
        width: 100%;
        height: 180px;
        overflow: hidden;
        position: relative;
        background-color: var(--bg-primary);
        margin-top: 0;
        padding: 10px 0;
        border-top: 1px solid var(--border-color);
        border-bottom: 1px solid var(--border-color);
    }
    .carousel-slider-wrapper {
        display: flex;
        height: 100%;
    }
    .carousel-slide-item {
        width: 150px;
        height: 150px;
        min-width: 150px;
        flex-shrink: 0;
        margin: 0 8px;
        position: relative;
        border-radius: 4px;
        overflow: hidden;
        box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        border: 1px solid var(--border-color);
        cursor: pointer;
        transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
    }
    .carousel-slide-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        border-color: var(--accent-primary);
    }
    .carousel-slide-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }
    .slider-nav, .slider-dots { display: none; }

    nav.category-navbar { background-color: var(--bg-primary); padding: 8px 0 !important; border-top: 1px solid var(--border-color); border-bottom: 1px solid var(--border-color); position: relative; }
    nav.category-navbar .container { display: flex; justify-content: space-between; align-items: center; }
    nav.category-navbar .left-group { display: flex; align-items: center; flex-grow: 1; overflow: hidden; }
    button.category-toggle { display: none; background: none; border: none; color: var(--accent-primary); font-size: 1.5em; cursor: pointer; padding: 5px 8px; margin-right: 8px; }
    
    a.custom-button-4khdhub {
        color: var(--bg-primary) !important;
        background: var(--accent-secondary);
        padding: 6px 10px;
        border-radius: 4px;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 4px;
        font-size: 0.85em;
        margin-right: 10px;
        white-space: nowrap;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        transition: background-color 0.2s ease, transform 0.2s ease;
        height: 36px;
        line-height: normal;
    }
    a.custom-button-4khdhub:hover { background-color: #d48c0f; transform: translateY(-1px); }
    a.custom-button-4khdhub i { margin-right: 3px; }

    .inline-mobile-search-form {
        display: none;
        align-items: center;
        margin-left: 15px;
    }
    .inline-mobile-search-form input[type="search"] {
        padding: 0 12px;
        border: 1px solid var(--border-color);
        background-color: var(--bg-tertiary);
        color: var(--text-primary);
        border-radius: 15px 0 0 15px;
        font-size: 0.85em;
        width: 140px;
        height: 36px;
        line-height: 36px;
    }
    .inline-mobile-search-form button {
        padding: 0 12px;
        height: 36px;
        background: var(--accent-primary);
        color: #fff;
        border: none;
        border-radius: 0 15px 15px 0;
        cursor: pointer;
        font-size: 0.9em;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .inline-mobile-search-form input[type="search"]:focus {
        outline: none;
        border-color: var(--accent-primary);
    }

    ul.category-links { list-style: none; display: flex; align-items: center; margin: 0; padding: 0; white-space: nowrap; }
    ul.category-links li { position: relative; margin-right: 3px; }
    ul.category-links li a { color: var(--text-secondary); padding: 6px 8px; display: block; font-size: 0.85em; border-radius: 3px; font-weight: 500; transition: background-color 0.2s ease, color 0.2s ease; cursor: pointer; }
    ul.category-links > li > a:hover, ul.category-links > li > a.active-category-link { background-color: var(--accent-primary); color: #fff; }
    ul.category-links li.dropdown .arrow { font-size: 0.6em; margin-left: 3px; }
    ul.category-links li .dropdown-menu { display: none; position: absolute; top: 100%; left: 0; background-color: var(--bg-tertiary); box-shadow: 0 4px 10px rgba(0,0,0,.3); padding: 5px 0; list-style: none; min-width: 180px; z-index: 1001; border-radius: 0 0 4px 4px; border: 1px solid var(--border-color); border-top: none; }
    ul.category-links li.dropdown:hover .dropdown-menu { display: block; }
    ul.category-links li .dropdown-menu li a { padding: 7px 10px; font-size: 0.8em; color: var(--text-secondary); }
    ul.category-links li .dropdown-menu li a:hover, ul.category-links li .dropdown-menu li a.active-category-link { background-color: var(--accent-primary); color: #fff; }

    .search-container { display: flex; align-items: center; margin-left: auto; }
    .search-container form { display: flex; }
    .search-container input[type="search"] { padding: 6px 9px; border: 1px solid var(--border-color); background-color: var(--bg-primary); color: var(--text-primary); border-radius: 15px 0 0 15px; font-size: 0.8em; width: 160px; transition: border-color 0.2s ease; }
    .search-container input[type="search"]:focus { outline: none; border-color: var(--accent-primary); }
    .search-container button { padding: 6px 9px; background: var(--accent-primary); color: #fff; border: none; border-radius: 0 15px 15px 0; cursor: pointer; font-size: 0.8em; font-weight: 500; transition: background-color 0.2s ease; }
    .search-container button:hover { background: var(--button-hover-primary); }

    section.sitewide-notice { background: var(--bg-tertiary); margin: 15px auto; padding: 10px 15px; color: var(--text-secondary); font-weight: 400; border-radius: 5px; text-align: center; font-size: 0.9em; width: 95%; max-width: 1350px; position: relative; border: 1px solid var(--border-color); box-shadow: 0 1px 3px var(--card-shadow); }
    section.sitewide-notice strong a, section.sitewide-notice a { color: var(--accent-primary) !important; font-weight: 500; }
    section.sitewide-notice a:hover { color: var(--accent-secondary) !important; }
    span.closebtn { color: var(--text-secondary); font-size: 20px; line-height: 1; position: absolute; top: 50%; right: 10px; transform: translateY(-50%); cursor: pointer; padding: 2px 5px; }
    span.closebtn:hover { color: var(--text-primary); }

    section.home-wrapper { padding: 15px 0; }
    h2.section-category-name { color: var(--text-primary); margin-bottom: 18px; margin-top: 12px; font-size: 1.5em; font-family: 'Rajdhani', sans-serif; padding: 8px 0; border-radius: 0; display: flex; align-items: center; font-weight: 600; border-bottom: 2px solid var(--accent-primary); }
    h2.section-category-name i { margin-right: 10px; color: var(--accent-primary); font-size: 1.1em; }

    ul.recent-movies-grid { list-style: none; display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 1rem; padding: 0; }
    li.movie-card-item { background: var(--bg-tertiary); border-radius: 5px; overflow: hidden; box-shadow: 0 2px 5px var(--card-shadow); transition: transform 0.25s ease-out, box-shadow 0.25s ease-out; display: flex; flex-direction: column; border: 1px solid var(--border-color); cursor: pointer; }
    li.movie-card-item:hover { transform: translateY(-5px); box-shadow: 0 5px 12px rgba(0,0,0,0.25); border-color: var(--accent-primary); }
    li.movie-card-item figure { margin: 0; position: relative; }
    li.movie-card-item figure img { width: 100%; height: 240px; object-fit: cover; display: block; }
    li.movie-card-item figcaption { padding: 12px 10px; background: var(--bg-tertiary); flex-grow: 1; display: flex; flex-direction: column; justify-content: center; min-height: 70px; }
    li.movie-card-item figcaption p.movie-title-link {
        color: var(--text-primary);
        font-size: 0.9em;
        font-weight: 600;
        line-height: 1.4;
        text-align: center;
    }

    .pagination-wrapper { text-align: center; margin: 30px 0 20px; }
    .pagination-wrapper ul.pagination { list-style: none; display: inline-flex; padding: 0; margin: 0; border-radius: 4px; overflow: hidden; box-shadow: 0 1px 3px var(--card-shadow); }
    .pagination-wrapper ul.pagination li button,
    .pagination-wrapper ul.pagination li span {
      color: var(--text-primary); background-color: var(--bg-tertiary);
      padding: 8px 13px; display: block;
      border: none;
      border-right: 1px solid var(--bg-primary);
      font-size: 0.9em; font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    .pagination-wrapper ul.pagination li:last-child button,
    .pagination-wrapper ul.pagination li:last-child span { border-right: none; }
    .pagination-wrapper ul.pagination li button:hover { background-color: var(--accent-primary); color: #fff; }
    .pagination-wrapper ul.pagination li button.current-page,
    .pagination-wrapper ul.pagination li span.current {
      background: var(--accent-primary); color: #fff; font-weight: bold; cursor: default;
    }
    .pagination-wrapper ul.pagination li span.dots { padding: 8px 10px; background-color: var(--bg-tertiary); color: var(--text-secondary); cursor: default; }
    .pagination-wrapper ul.pagination li button:disabled {
        background-color: var(--bg-tertiary);
        color: var(--text-secondary);
        cursor: not-allowed;
        opacity: 0.6;
    }

    footer.primary-footer { margin-top: 25px; color: var(--text-secondary); background: var(--bg-secondary); padding: 20px 0; font-size: 0.85em; border-top: 2px solid var(--border-color); }
    footer.primary-footer .container { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
    footer.primary-footer .footer-brand p { margin: 5px 0; }
    footer.primary-footer .footer-brand span a { font-weight: 600; color: var(--accent-primary) !important; }
    footer.primary-footer .footer-links ul { list-style: none; display: flex; flex-wrap: wrap; padding: 0; margin: 5px 0; }
    footer.primary-footer .footer-links ul li { margin-left: 12px; }
    footer.primary-footer .footer-links ul li a { color: var(--text-secondary); }
    footer.primary-footer .footer-links ul li a:hover { color: var(--accent-primary); }

    .status-message { grid-column: 1 / -1; text-align: center; font-size: 1.05em; color: var(--text-secondary); padding: 25px 15px; border-radius: 4px; background-color: var(--bg-tertiary); margin: 15px 0; border: 1px solid var(--border-color); }
    .status-message.error { color: #E57373; border-color: #E57373; }
    .loading-spinner { width: 35px; height: 35px; border: 3px solid var(--border-color); border-top-color: var(--accent-primary); border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 8px auto; }
    @keyframes spin { to { transform: rotate(360deg); } }

    .movie-modal {
      display: none; position: fixed; z-index: 1005; left: 0; top: 0;
      width: 100%; height: 100%; overflow: auto;
      background-color: rgba(0,0,0,0.85);
      backdrop-filter: blur(6px);
    }
    .movie-modal-content {
      background-color: var(--bg-secondary); margin: 4% auto;
      padding: 20px 25px;
      border: 1px solid var(--border-color); border-radius: 6px;
      width: 90%; max-width: 750px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      position: relative; animation: modalAppear 0.35s ease-out;
    }
    @keyframes modalAppear {
        from { opacity: 0; transform: scale(0.95) translateY(-20px); }
        to { opacity: 1; transform: scale(1) translateY(0); }
    }
    .modal-close-button {
      color: var(--text-secondary); position: absolute; top: 10px; right: 15px;
      font-size: 30px; font-weight: bold; line-height: 1;
    }
    .modal-close-button:hover, .modal-close-button:focus {
      color: var(--accent-primary); text-decoration: none; cursor: pointer;
    }
    .modal-top-section { display: flex; gap: 20px; margin-bottom: 15px; }
    .modal-poster {
      width: 180px;
      min-width: 180px;
      height: auto; border-radius: 5px;
      object-fit: cover;
      border: 2px solid var(--border-color);
    }
    .modal-header-info { flex-grow: 1; text-align: left; }
    .modal-movie-title {
        font-family: 'Rajdhani', sans-serif;
        font-size: 2.2em;
        color: var(--accent-primary);
        margin-bottom: 8px;
        line-height: 1.2;
        text-align: left;
    }
    .modal-movie-info p {
        margin-bottom: 6px;
        font-size: 0.9em;
        color: var(--text-secondary);
        text-align: left;
    }
    .modal-movie-info p strong { color: var(--text-primary); margin-right: 5px; font-weight: 500; }

    .modal-movie-description { margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border-color); text-align: left; }
    .modal-movie-description h4 { color: var(--accent-secondary); margin-bottom: 8px; font-size: 1.15em; font-family: 'Rajdhani', sans-serif;}
    .modal-movie-description p { font-size: 0.95em; line-height: 1.7; }

    .modal-screenshots { margin-top: 20px; text-align: left;}
    .modal-screenshots h4 { color: var(--accent-secondary); margin-bottom: 10px; font-size: 1.15em; font-family: 'Rajdhani', sans-serif;}
    .screenshots-gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 8px; }
    .screenshots-gallery img { width: 100%; height: auto; border-radius: 4px; border: 1px solid var(--border-color); cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
    .screenshots-gallery img:hover { transform: scale(1.08); box-shadow: 0 0 8px var(--accent-primary); }

    .modal-download-section {
        margin-top: 25px;
        padding-top: 20px;
        border-top: 1px solid var(--border-color);
        text-align: center;
    }
    .modal-download-section .download-section-main-title {
        font-size: 1.1em;
        font-weight: 500;
        color: var(--text-primary);
        margin-bottom: 5px;
        text-align: left;
    }
    .modal-download-section .download-section-subtitle {
        font-size: 1em;
        font-weight: bold;
        color: var(--download-section-title-color);
        margin-bottom: 15px;
    }
    .download-links-container {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    .download-link-item {
        display: block; /* Default to block, JS will hide if no link */
        background-color: var(--bg-tertiary);
        color: var(--download-link-color) !important;
        padding: 10px 15px;
        border-radius: 4px;
        text-align: center;
        font-weight: 500;
        font-size: 0.95em;
        border: 1px solid var(--border-color);
        transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    }
    .download-link-item:hover {
        background-color: var(--accent-primary);
        color: #fff !important;
        border-color: var(--accent-primary);
    }
    .download-link-item i { margin-right: 8px; }


    @media (max-width: 1024px) {
        nav.category-navbar .category-toggle { display: block; }
        nav.category-navbar .left-group { overflow: visible; }
        .inline-mobile-search-form { display: flex; }
        nav.category-navbar .search-container { display: none; }
        #categoryLinks #mobile-search-item { display: none !important; }

        ul.category-links {
            display: none; flex-direction: column; position: fixed;
            top: 0; left: -100%; width: 80%; max-width: 280px; height: 100vh;
            background-color: var(--bg-secondary);
            padding-top: 15px; transition: left 0.3s ease-in-out;
            z-index: 2000; overflow-y: auto;
            border-right: 1px solid var(--border-color);
            box-shadow: 2px 0 8px rgba(0,0,0,0.2);
        }
        ul.category-links.active { left: 0; display: flex; }
        ul.category-links li { width: 100%; margin-right: 0; border-bottom: 1px solid var(--border-color); }
        ul.category-links li:last-child { border-bottom: none; }
        ul.category-links li a { padding: 12px 18px; color: var(--text-primary); font-size: 0.95em; }
        ul.category-links li a:hover { background-color: var(--accent-primary); color: #fff; }
        ul.category-links li .dropdown-menu {
            position: static; background-color: var(--bg-primary);
            box-shadow: none; border-radius: 0; border: none; padding-left: 20px;
        }
        ul.category-links li .dropdown-menu li a { font-size: 0.9em; color: var(--text-secondary); }

        a.custom-button-4khdhub {
            font-size: 0.8em;
            padding: 0 10px;
            height: 36px;
            margin-right: 8px;
        }
        .inline-mobile-search-form {
            margin-left: 12px;
        }
        .inline-mobile-search-form input[type="search"] {
            width: 120px;
            font-size: 0.8em;
            height: 36px;
            padding: 0 10px;
        }
        .inline-mobile-search-form button {
            height: 36px;
            font-size: 0.85em;
            padding: 0 10px;
        }
    }

    @media (max-width: 767px) {
        ul.recent-movies-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
        }
        li.movie-card-item figure img { height: auto; aspect-ratio: 2/3; }
        li.movie-card-item figcaption { min-height: 60px; padding: 8px; }
        li.movie-card-item figcaption p.movie-title-link { font-size: 0.85em; }

        .modal-top-section { flex-direction: column; align-items: stretch; text-align: left; }
        .modal-poster { align-self: center; float: none; margin-right: 0; margin-bottom: 15px; width: 60%; max-width: 200px; }
        .modal-header-info { text-align: left;}
        .modal-movie-title { font-size: 1.8em; text-align: left;}
        .modal-movie-info p { text-align: left; }

        a.custom-button-4khdhub {
            font-size: 0.8em;
            padding: 0 10px;
            height: 36px;
            margin-right: 8px;
        }
        .inline-mobile-search-form {
            margin-left: 12px;
        }
        .inline-mobile-search-form input[type="search"] {
            width: 110px;
            font-size: 0.8em;
            height: 36px;
            padding: 0 10px;
        }
        .inline-mobile-search-form button {
            height: 36px;
            font-size: 0.85em;
             padding: 0 10px;
        }
    }
  </style>
</head>
<body>

  <header class="primary-header">
    <nav class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">
             <img src="FlixHutHD.png" alt="FlixHutHD Logo" class="site-logo" onerror="this.style.display='none'; this.onerror=null; const span = document.createElement('span'); span.className='site-title-text'; span.textContent='FlixHutHD'; this.parentNode.replaceChild(span, this);">
          </a>
        </div>
      </div>
    </nav>
    <div class="carousel-slider-container" id="carouselImageSlider">
        <div class="carousel-slider-wrapper">
            </div>
    </div>

    <nav class="category-navbar">
      <div class="container">
        <button type="button" class="category-toggle" id="categoryMenuToggle">
          <i class="fas fa-bars"></i>
        </button>
        <div class="left-group">
          <a href="#" class="custom-button-4khdhub">
            <i class="fa fa-film"></i> 4kFlixHD
          </a>
          <form id="inlineMobileSearchForm" class="inline-mobile-search-form">
            <input type="search" name="s" placeholder="Search..." autocomplete="off">
            <button type="submit"><i class="fas fa-search"></i></button>
          </form>
          <ul class="category-links" id="categoryLinks">
            <li id="mobile-search-item" style="display: none;">
                <form method="get" id="mobileSearchFormInMenu" action="#">
                    <input type="search" name="s" placeholder="Search here..." autocomplete="off">
                </form>
            </li>
            <li><a href="#" data-category="All" class="active-category-link">Home <i class="fas fa-home fa-xs" style="margin-left: 5px;"></i></a></li>
            <li><a href="#" data-category="Bollywood">Bollywood</a></li>
            <li><a href="#" data-category="Hollywood">Hollywood</a></li>
            <li><a href="#" data-category="Hindi Dubbed">Hindi Dubbed</a></li>
            <li><a href="#" data-category="South Hindi">South Hindi</a></li>
            <li class="dropdown">
              <a href="#">Genres <span class="arrow">▾</span></a>
              <ul class="dropdown-menu">
                <li><a href="#" data-category="Action">Action</a></li>
                <li><a href="#" data-category="Comedy">Comedy</a></li>
                <li><a href="#" data-category="Horror">Horror</a></li>
                <li><a href="#" data-category="Sci-Fi">Sci-Fi</a></li>
                <li><a href="#" data-category="Romance">Romance</a></li>
                <li><a href="#" data-category="Thriller">Thriller</a></li>
                <li><a href="#" data-category="Drama">Drama</a></li>
              </ul>
            </li>
            <li><a href="#" data-category="Web Series">Web Series</a></li>
            <li><a href="#" data-category="Anime">Anime</a></li>
            <li><a href="#" data-category="Cartoon">Cartoon</a></li>
            <li><a href="#" data-category="Other">Other</a></li>
          </ul>
        </div>
        <div class="search-container" id="desktopSearchContainer">
          <form method="get" action="#" id="desktopSearchForm">
            <input type="search" name="s" id="desktopSearchInput" class="form-control" placeholder="Search movies..." autocomplete="off">
            <button type="submit"><i class="fas fa-search"></i></button>
          </form>
        </div>
      </div>
    </nav>
  </header>

  <div class="container">
    <section class="sitewide-notice">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
        Stay updated! Follow us on our <a href="#">Telegram Channel</a> for the latest movies.
    </section>

    <section class="home-wrapper">
      <h2 class="section-category-name" id="currentCategoryTitle">
        <i class="fas fa-bolt"></i>
        <span>All Movies</span>
      </h2>
      <ul class="recent-movies-grid" id="movies-grid">
        </ul>
      <div class="clearfix" style="clear:both;"></div>

      <div class="pagination-wrapper" id="paginationControls">
        </div>
    </section>
  </div>

  <footer class="primary-footer">
    <div class="container">
      <div class="footer-brand">
        <p>&copy; <span id="currentYear">2025</span> <span><a href="#">FlixHutHD</a></span> | All Rights Reserved.</p>
      </div>
      <div class="footer-links">
        <ul>
          <li><a href="#">About Us</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Contact</a></li>
        </ul>
      </div>
    </div>
  </footer>

  <div id="movieDetailModal" class="movie-modal">
    <div class="movie-modal-content">
      <span class="modal-close-button">&times;</span>
      <div class="modal-top-section">
        <img src="" alt="Movie Poster" class="modal-poster" id="modalPoster">
        <div class="modal-header-info">
            <h3 class="modal-movie-title" id="modalTitle">Movie Title</h3>
            <div class="modal-movie-info">
                <p><strong>Category:</strong> <span id="modalCategory">N/A</span></p>
                <p><strong>IMDb Rating:</strong> <span id="modalImdbRating">N/A</span></p>
                <p><strong>Stars:</strong> <span id="modalStars">N/A</span></p>
                <p><strong>Director:</strong> <span id="modalDirector">N/A</span></p>
            </div>
        </div>
      </div>
      <div class="modal-movie-description">
        <h4>Description:</h4>
        <p id="modalDescription">No description available.</p>
      </div>

      <div class="modal-screenshots">
        <h4>Screenshots:</h4>
        <div class="screenshots-gallery" id="modalScreenshotsGallery">
          </div>
      </div>
      <div class="modal-download-section">
        <h3 class="download-section-main-title" id="modalDownloadMainTitle">Download Movie Title Full Movie in Hindi | HD</h3>
        <h4 class="download-section-subtitle">: DOWNLOAD MOVIE  :</h4>
        <div class="download-links-container" id="modalDownloadLinksContainer">
            <a href="#" id="download480pButton" class="download-link-item" target="_blank"><i class="fas fa-download"></i> DOWNLOAD 480P</a>
            <a href="#" id="download720pButton" class="download-link-item" target="_blank"><i class="fas fa-download"></i> DOWNLOAD 720P</a>
            <a href="#" id="download1080pButton" class="download-link-item" target="_blank"><i class="fas fa-download"></i> DOWNLOAD 1080P</a>
            <a href="#" id="download4kButton" class="download-link-item" target="_blank"><i class="fas fa-download"></i> DOWNLOAD 4K</a>
            <p id="noDownloadLinksMessage" style="color: var(--text-secondary); font-size: 0.9em; display: none;">No download links available.</p>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    // Firebase and DOM Elements Initialization
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDS3t1LHKVXcsu2c3G2fR1dmD_Ts_9R95o", // User's Firebase API Key
      authDomain: "flixhuthd.firebaseapp.com",
      projectId: "flixhuthd",
      storageBucket: "flixhuthd.appspot.com",
      messagingSenderId: "716214559037",
      appId: "1:716214559037:web:5d26537a8ba8282f47e554",
      measurementId: "G-TLELC9VFL2"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // DOM Element variables
    const movieContainer = document.getElementById('movies-grid');
    const categoryLinksContainer = document.getElementById('categoryLinks');
    const currentCategoryTitleEl = document.getElementById('currentCategoryTitle').querySelector('span');
    const paginationControls = document.getElementById('paginationControls');
    const modal = document.getElementById("movieDetailModal");
    const modalCloseButton = modal.querySelector(".modal-close-button");
    const modalPoster = document.getElementById("modalPoster");
    const modalTitle = document.getElementById("modalTitle");
    const modalCategory = document.getElementById("modalCategory");
    const modalImdbRating = document.getElementById("modalImdbRating");
    const modalStars = document.getElementById("modalStars");
    const modalDirector = document.getElementById("modalDirector");
    const modalDescription = document.getElementById("modalDescription");
    const modalScreenshotsGallery = document.getElementById("modalScreenshotsGallery");
    const modalDownloadMainTitle = document.getElementById("modalDownloadMainTitle");

    // Static Download Buttons from HTML
    const download480pButton = document.getElementById('download480pButton');
    const download720pButton = document.getElementById('download720pButton');
    const download1080pButton = document.getElementById('download1080pButton');
    const download4kButton = document.getElementById('download4kButton');
    const noDownloadLinksMessage = document.getElementById('noDownloadLinksMessage');

    const sliderWrapper = document.querySelector("#carouselImageSlider .carousel-slider-wrapper");

    // Global variables
    let sliderImages = [];
    let scrollAmount = 0;
    const slideItemWidth = 150 + 16;
    let animationFrameId;
    let allMoviesData = [];
    let currentFilteredMovies = [];
    let currentPage = 1;
    const moviesPerPage = 18;

    // Function to set the current year in the footer
    function setCurrentFooterYear() {
        const yearSpan = document.getElementById('currentYear');
        if (yearSpan) {
            yearSpan.textContent = new Date().getFullYear();
        }
    }

    // Function to create and populate the carousel slider
    function createSlider() {
        if (!sliderWrapper) { console.warn("Slider wrapper not found."); return; }
        if (sliderImages.length === 0) {
             sliderWrapper.innerHTML = `<div class="carousel-slide-item" style="width:100%; height:100%; margin:0; display:flex; align-items:center; justify-content:center; background-color: var(--bg-tertiary);">
                                            <span style="color: var(--text-secondary);">No featured movies.</span>
                                        </div>`;
            return;
        }
        sliderWrapper.innerHTML = '';
        let imagesToDisplayInSlider = sliderImages.slice(0, 14);
         if (imagesToDisplayInSlider.length === 0) {
            sliderWrapper.innerHTML = `<div class="carousel-slide-item" style="width:100%; height:100%; margin:0; display:flex; align-items:center; justify-content:center; background-color: var(--bg-tertiary);">
                                           <span style="color: var(--text-secondary);">No featured movies.</span>
                                       </div>`;
            return;
        }

        const numDuplicates = Math.max(3, Math.ceil( ( (sliderWrapper.parentElement.offsetWidth || 1200) / slideItemWidth) * 2 / imagesToDisplayInSlider.length));
        let duplicatedImages = [];
        for(let i = 0; i < numDuplicates; i++) {
            duplicatedImages = duplicatedImages.concat(imagesToDisplayInSlider);
        }

        duplicatedImages.forEach((imgPath) => {
            const slideDiv = document.createElement('div');
            slideDiv.classList.add('carousel-slide-item');
            const originalMovie = allMoviesData.find(movie => movie.data.poster === imgPath);
            if (originalMovie) {
                slideDiv.setAttribute('data-movie-id', originalMovie.id);
                slideDiv.addEventListener('click', function() { openMovieModal(this.dataset.movieId); });
            }

            const img = document.createElement('img');
            img.src = imgPath;
            img.alt = "Promotional Slide";
            img.onerror = function() { this.src='https://placehold.co/150x150/1E1E1E/E0E0E0?text=Error'; this.alt='Image load error'; };
            slideDiv.appendChild(img);
            sliderWrapper.appendChild(slideDiv);
        });
        startContinuousSlide();
    }

    // Function for continuous scrolling animation
    function continuousScroll() {
        if (!sliderWrapper || sliderImages.length === 0) return;
        scrollAmount += 0.5;
        sliderWrapper.style.transform = `translateX(-${scrollAmount}px)`;

        const originalSlidesForLoop = sliderImages.slice(0, 14);
        if (originalSlidesForLoop.length === 0) return;

        const totalWidthOriginalSlides = originalSlidesForLoop.length * slideItemWidth;

        if (scrollAmount >= totalWidthOriginalSlides) {
            scrollAmount = 0;
            sliderWrapper.style.transform = 'translateX(0px)';
        }
        animationFrameId = requestAnimationFrame(continuousScroll);
    }

    // Function to start or restart the continuous slide
    function startContinuousSlide() {
        if (sliderImages.length === 0 || !sliderWrapper) return;
        cancelAnimationFrame(animationFrameId);
        scrollAmount = 0;
        sliderWrapper.style.transform = 'translateX(0px)';
        animationFrameId = requestAnimationFrame(continuousScroll);
    }

    // Function to open and populate the movie detail modal
    function openMovieModal(movieId) {
        const movie = allMoviesData.find(m => m.id === movieId);
        if (!movie || !movie.data) { console.error("Movie data not found for ID:", movieId); return; }
        const data = movie.data;

        modalPoster.src = data.poster || 'https://placehold.co/180x270/1E1E1E/E0E0E0?text=No+Poster';
        modalPoster.alt = `${data.name || "Movie"} Poster`;
        modalTitle.textContent = data.name || "Title Not Available";
        modalCategory.textContent = data.category || "N/A";
        modalImdbRating.textContent = data.imdbRating || "N/A";
        
        // --- এই অংশটি পরিবর্তন করা হয়েছে ---
        let starsDisplay = "N/A";
        const numStars = parseInt(data.stars, 10); // ফায়ারবেস থেকে আসা সংখ্যাটিকে ইন্টিজারে রূপান্তর করুন
        if (!isNaN(numStars) && numStars > 0) {
            starsDisplay = '⭐'.repeat(numStars); // স্টার ইমোজি তৈরি করুন
        }
        modalStars.textContent = starsDisplay;
        // --- পরিবর্তন শেষ ---

        modalDirector.textContent = data.director || "N/A";
        modalDescription.textContent = data.description || "No description available.";

        modalDownloadMainTitle.textContent = `Download ${data.name || 'Movie'}`;

        // Hide all static buttons and the "no links" message initially
        if(download480pButton) download480pButton.style.display = 'none';
        if(download720pButton) download720pButton.style.display = 'none';
        if(download1080pButton) download1080pButton.style.display = 'none';
        if(download4kButton) download4kButton.style.display = 'none';
        if(noDownloadLinksMessage) noDownloadLinksMessage.style.display = 'none';

        let linksWereActuallySet = false;

        // Map of quality info to corresponding button elements
        // Added some common alternative keywords for each quality
        const qualityButtonMap = [
            { button: download480pButton,  regex: /480p/i, alt: ['sd', 'standard', '480'] },
            { button: download720pButton,  regex: /720p|hd/i, alt: ['hd ready', '720'] },
            { button: download1080pButton, regex: /1080p|fhd|fullhd/i, alt: ['full hd', '1080'] },
            { button: download4kButton,    regex: /4k|uhd|2160p|ultra.?hd/i, alt: ['ultra hd', '2160'] }
        ];

        if (data.downloadLinks && typeof data.downloadLinks === 'object') {
            qualityButtonMap.forEach(qMap => {
                if (!qMap.button) {
                     console.warn(`Button for quality (regex: ${qMap.regex}) not found in HTML for movie: ${data.name}`);
                     return;
                }

                let linkUrl = null;
                for (const keyInFirebase in data.downloadLinks) {
                    if (data.downloadLinks.hasOwnProperty(keyInFirebase) && typeof data.downloadLinks[keyInFirebase] === 'string') {
                        const lowerKey = keyInFirebase.toLowerCase();
                        if (qMap.regex.test(lowerKey) || (qMap.alt && qMap.alt.some(altKey => lowerKey.includes(altKey.toLowerCase())))) {
                            linkUrl = data.downloadLinks[keyInFirebase];
                            break;
                        }
                    }
                }
                if (linkUrl) {
                    qMap.button.href = linkUrl;
                    qMap.button.style.display = 'block'; // Show the button
                    linksWereActuallySet = true;
                } else {
                    qMap.button.style.display = 'none'; // Ensure button is hidden if no specific link found
                }
            });
        }

        // Fallback for data.url for 1080p button IF no specific quality links were found AND data.url exists
        if (!linksWereActuallySet && data.url) {
            if (download1080pButton) {
                download1080pButton.href = data.url;
                download1080pButton.style.display = 'block';
                linksWereActuallySet = true;
            }
        }

        // If still no links were set after checking downloadLinks and data.url, show the "no links" message
        if (!linksWereActuallySet && noDownloadLinksMessage) {
            noDownloadLinksMessage.style.display = 'block';
        }

        // Populate screenshots
        modalScreenshotsGallery.innerHTML = '';
        let screenshotUrls = [];
        if (Array.isArray(data.screenshots)) {
            screenshotUrls = data.screenshots.filter(url => url && url.trim() !== "");
        } else if (typeof data.screenshots === 'string' && data.screenshots.trim() !== "") {
            screenshotUrls = data.screenshots.split(',').map(url => url.trim()).filter(url => url);
        }

        if (screenshotUrls.length > 0) {
            screenshotUrls.forEach(ssUrl => {
                const img = document.createElement('img');
                img.src = ssUrl;
                img.alt = "Screenshot";
                img.onerror = function() { this.src='https://placehold.co/120x70/282828/BDBDBD?text=No+SS'; };
                modalScreenshotsGallery.appendChild(img);
            });
        } else {
            modalScreenshotsGallery.innerHTML = '<p style="color: var(--text-secondary); font-size: 0.9em;">No screenshots available.</p>';
        }

        modal.style.display = "block";
        document.body.classList.add("modal-open");
    }


    // Event listeners for modal close
    if (modalCloseButton) {
        modalCloseButton.onclick = function() { modal.style.display = "none"; document.body.classList.remove("modal-open"); }
    }
    window.onclick = function(event) {
        if (event.target == modal) { modal.style.display = "none"; document.body.classList.remove("modal-open"); }
    }

    // Function to render movies on the page
    function renderMovies(page = 1) {
        if (!movieContainer) { console.error("Movie container not found."); return; }
        movieContainer.innerHTML = ''; // Clear existing movies
        currentPage = page;
        const startIndex = (currentPage - 1) * moviesPerPage;
        const endIndex = startIndex + moviesPerPage;
        const moviesToDisplay = currentFilteredMovies.slice(startIndex, endIndex);

        if (!moviesToDisplay || moviesToDisplay.length === 0) {
            movieContainer.innerHTML = '<div class="status-message">No movies found for this criteria.</div>';
            setupPagination(currentFilteredMovies.length, moviesPerPage, currentPage); // Update pagination even if no movies
            return;
        }

        moviesToDisplay.forEach((movieData) => {
            const data = movieData.data;
            const id = movieData.id;
            const movieEl = document.createElement('li');
            movieEl.classList.add('movie-card-item');
            movieEl.setAttribute('data-movie-id', id);

            const bgColorPlaceholder = getComputedStyle(document.documentElement).getPropertyValue('--bg-tertiary').trim().substring(1) || '282828';
            const textColorPlaceholder = getComputedStyle(document.documentElement).getPropertyValue('--accent-primary').trim().substring(1) || '3498DB';
            const posterUrl = data.poster || `https://placehold.co/340x510/${bgColorPlaceholder}/${textColorPlaceholder}?text=${encodeURIComponent(data.name || "No Name")}`;

            movieEl.innerHTML = `
                <figure>
                  <img src="${posterUrl}" alt="${data.name || "Movie"} Poster" onerror="this.onerror=null; this.src='https://placehold.co/340x510/${bgColorPlaceholder}/BDBDBD?text=Image+Not+Found';">
                </figure>
                <figcaption>
                  <p class="movie-title-link">${data.name || "Untitled Movie"}</p>
                </figcaption>`;
            movieEl.addEventListener('click', function() { openMovieModal(this.dataset.movieId); });
            movieContainer.appendChild(movieEl);
        });
        setupPagination(currentFilteredMovies.length, moviesPerPage, currentPage);
    }

    // Function to set up pagination controls
    function setupPagination(totalItems, itemsPerPage, page) {
        if (!paginationControls) { console.warn("Pagination controls container not found."); return; }
        paginationControls.innerHTML = ""; // Clear existing pagination
        const pageCount = Math.ceil(totalItems / itemsPerPage);
        if (pageCount <= 1) return; // No pagination needed for one page or less

        const ul = document.createElement('ul');
        ul.classList.add('pagination');

        // Previous button
        const prevButton = document.createElement('button');
        prevButton.innerHTML = '<i class="fas fa-angle-left"></i> Prev';
        prevButton.disabled = page === 1;
        prevButton.addEventListener('click', () => { if (page > 1) renderMovies(page - 1); });
        const prevLi = document.createElement('li');
        prevLi.appendChild(prevButton);
        ul.appendChild(prevLi);

        // Page number buttons (with ellipsis logic)
        let startPage = Math.max(1, page - 2);
        let endPage = Math.min(pageCount, page + 2);
        if (page <= 3) endPage = Math.min(pageCount, 5);
        if (page > pageCount - 3) startPage = Math.max(1, pageCount - 4);

        if (startPage > 1) {
            const firstPageButton = document.createElement('button');
            firstPageButton.textContent = '1';
            firstPageButton.addEventListener('click', () => renderMovies(1));
            const firstLi = document.createElement('li');
            firstLi.appendChild(firstPageButton);
            ul.appendChild(firstLi);
            if (startPage > 2) {
                 const dots = document.createElement('span');
                 dots.classList.add('dots'); dots.textContent = '...';
                 const dotsLi = document.createElement('li');
                 dotsLi.appendChild(dots); ul.appendChild(dotsLi);
            }
        }

        for (let i = startPage; i <= endPage; i++) {
            const pageButton = document.createElement('button');
            pageButton.textContent = i;
            if (i === page) { pageButton.classList.add('current-page'); pageButton.disabled = true; }
            pageButton.addEventListener('click', () => renderMovies(i));
            const li = document.createElement('li');
            li.appendChild(pageButton); ul.appendChild(li);
        }

        if (endPage < pageCount) {
            if (endPage < pageCount - 1) {
                const dots = document.createElement('span');
                dots.classList.add('dots'); dots.textContent = '...';
                const dotsLi = document.createElement('li');
                dotsLi.appendChild(dots); ul.appendChild(dotsLi);
            }
            const lastPageButton = document.createElement('button');
            lastPageButton.textContent = pageCount;
            lastPageButton.addEventListener('click', () => renderMovies(pageCount));
            const lastLi = document.createElement('li');
            lastLi.appendChild(lastPageButton); ul.appendChild(lastLi);
        }

        // Next button
        const nextButton = document.createElement('button');
        nextButton.innerHTML = 'Next <i class="fas fa-angle-right"></i>';
        nextButton.disabled = page === pageCount;
        nextButton.addEventListener('click', () => { if (page < pageCount) renderMovies(page + 1); });
        const nextLi = document.createElement('li');
        nextLi.appendChild(nextButton);
        ul.appendChild(nextLi);

        paginationControls.appendChild(ul);
    }

    // Function to filter movies by category and display them
    function filterAndDisplayMovies(category) {
        // Update active link in category navigation
        document.querySelectorAll('#categoryLinks a[data-category]').forEach(link => {
            link.classList.remove('active-category-link');
            if (link.dataset.category === category) { link.classList.add('active-category-link'); }
        });
        // Update the section title
        if (currentCategoryTitleEl) { currentCategoryTitleEl.textContent = category === "All" ? "All Movies" : category; }

        // Clear search inputs
        const desktopSearchInput = document.getElementById('desktopSearchInput');
        if(desktopSearchInput) { desktopSearchInput.value = ''; }
        const inlineMobileSearchInput = document.querySelector('#inlineMobileSearchForm input[name="s"]');
        if(inlineMobileSearchInput) { inlineMobileSearchInput.value = ''; }

        // Filter movies
        if (category === "All") { currentFilteredMovies = [...allMoviesData]; }
        else { currentFilteredMovies = allMoviesData.filter(movie => movie.data.category && movie.data.category === category); }
        renderMovies(1); // Render the first page of filtered movies
    }

    // Async function to load all movies from Firestore
    async function loadAllMovies() {
      if (!movieContainer) { console.error("Movie container not found, cannot load movies."); return; }
      movieContainer.innerHTML = '<div id="loadingIndicator" class="status-message"><div class="loading-spinner"></div><p>Loading Movies...</p></div>';
      if (paginationControls) paginationControls.innerHTML = ''; // Clear pagination while loading
      try {
        const querySnapshot = await getDocs(collection(db, "movies"));
        allMoviesData = []; // Reset movie data
        querySnapshot.forEach((doc) => { allMoviesData.push({ id: doc.id, data: doc.data() }); });

        // Prepare images for the slider (posters of first few movies)
        sliderImages = allMoviesData
            .map(movie => movie.data.poster)
            .filter(poster => poster && poster.trim() !== "") // Ensure poster URL is valid
            .slice(0, 14); // Limit to 14 images for the slider
        createSlider(); // Create/recreate the slider with new images

        currentFilteredMovies = [...allMoviesData]; // Initially show all movies
        filterAndDisplayMovies("All"); // Display all movies by default

      } catch (error) {
        console.error("Error loading all movies: ", error);
        movieContainer.innerHTML = '<div class="status-message error"><i class="fas fa-exclamation-triangle"></i> Error loading movies. Please try again later.</div>';
        createSlider(); // Attempt to create slider even on error (might show no featured movies)
      }
    }

    // Event listener for category links
    if (categoryLinksContainer) {
        categoryLinksContainer.addEventListener('click', function(event) {
            const targetLink = event.target.closest('a[data-category]');
            if (targetLink) {
                event.preventDefault();
                const category = targetLink.dataset.category;
                filterAndDisplayMovies(category);
                // Close mobile menu if open after category selection
                if (window.innerWidth <= 1024 && categoryLinksUl.classList.contains("active")) {
                    categoryLinksUl.classList.remove("active");
                    document.body.classList.remove("category-menu-open");
                }
            }
        });
    }

    // Mobile category menu toggle
    const categoryMenuToggle = document.getElementById("categoryMenuToggle");
    const categoryLinksUl = document.getElementById("categoryLinks");
    const desktopSearch = document.getElementById("desktopSearchContainer"); // Used in resize handler

    if (categoryMenuToggle && categoryLinksUl) {
        categoryMenuToggle.addEventListener("click", function(e) {
            e.stopPropagation(); // Prevent click from bubbling to document
            const isActive = categoryLinksUl.classList.toggle("active");
            document.body.classList.toggle("category-menu-open", isActive); // Prevent body scroll when menu is open
        });
    }
    // Close mobile menu if clicked outside
    document.addEventListener("click", function(e) {
        if (categoryLinksUl && categoryMenuToggle && categoryLinksUl.classList.contains("active")) {
            if (!categoryLinksUl.contains(e.target) && !categoryMenuToggle.contains(e.target)) {
                categoryLinksUl.classList.remove("active");
                document.body.classList.remove("category-menu-open");
                closeAllMobileDropdowns(document.querySelectorAll("#categoryLinks li.dropdown"));
            }
        }
    });

    function closeAllMobileDropdowns(dropdownList) {
        dropdownList.forEach(d => {
            d.classList.remove("open");
            const menu = d.querySelector(".dropdown-menu");
            if (menu) menu.style.display = "none";
        });
    }

    // Setup dropdowns for desktop hover and mobile click
    function setupDropdowns(navElement) {
        if (!navElement) return;
        const dropdowns = navElement.querySelectorAll("li.dropdown");
        dropdowns.forEach(dropdown => {
            const link = dropdown.querySelector("a:first-child"); // The link that toggles the dropdown
            const menu = dropdown.querySelector(".dropdown-menu"); // The dropdown menu itself
            if (link && menu) {
                if (window.innerWidth > 1024 && navElement.id === 'categoryLinks') { // Desktop: Hover
                     dropdown.addEventListener('mouseenter', () => menu.style.display = 'block');
                     dropdown.addEventListener('mouseleave', () => menu.style.display = 'none');
                } else { // Mobile: Click (only when main mobile menu is active)
                    link.addEventListener("click", function(event) {
                        if (navElement.classList.contains("active")) { // Only toggle if the parent menu is active (mobile slide-out)
                            event.preventDefault(); event.stopPropagation();
                            const isOpen = dropdown.classList.toggle("open");
                            menu.style.display = isOpen ? "block" : "none";
                        }
                    });
                }
                // Prevent dropdown menu clicks from closing the main mobile menu
                menu.addEventListener("click", function(event) { event.stopPropagation(); });
            }
        });
    }
    setupDropdowns(categoryLinksUl); // Initial setup

    // Handle window resize to adjust menu behavior
    function handleResize() {
        const isDesktop = window.innerWidth > 1024;
        if (isDesktop) {
            // If switching to desktop, close mobile menu and reset dropdowns
            if (categoryLinksUl) {
                categoryLinksUl.classList.remove('active');
                document.querySelectorAll("#categoryLinks li.dropdown").forEach(dropdown => {
                    dropdown.classList.remove("open");
                    const menu = dropdown.querySelector(".dropdown-menu");
                    if (menu) menu.style.display = ""; // Reset display for hover
                });
            }
            document.body.classList.remove("category-menu-open");
            if(desktopSearch) desktopSearch.style.display = 'flex'; // Show desktop search
        } else {
             // If switching to mobile
             if (categoryLinksUl && !categoryLinksUl.classList.contains('active')) {
                // If mobile menu is not active, ensure dropdowns are not showing as block
             }
             // Ensure all mobile dropdowns are reset (closed) if mobile menu is not active
             document.querySelectorAll("#categoryLinks li.dropdown").forEach(dropdown => {
                const menu = dropdown.querySelector(".dropdown-menu");
                if (menu) menu.style.display = "none"; // Hide dropdown menus
                dropdown.classList.remove("open"); // Remove open class
             });
        }
        // Re-setup dropdowns to apply correct event listeners (hover for desktop, click for mobile)
        document.querySelectorAll("#categoryLinks li.dropdown").forEach(dropdown => {
            const link = dropdown.querySelector("a:first-child");
            const menu = dropdown.querySelector(".dropdown-menu");
            if (link && menu) {
                // Crude way to remove old listeners: clone and replace the link element
                const newLink = link.cloneNode(true); // True to clone children (like the arrow span)
                if (link.parentNode) { link.parentNode.replaceChild(newLink, link); }

                if (window.innerWidth > 1024) { // Desktop view
                    menu.style.display = ''; // Reset any inline style from mobile
                    dropdown.addEventListener('mouseenter', () => menu.style.display = 'block');
                    dropdown.addEventListener('mouseleave', () => menu.style.display = 'none');
                } else { // Mobile view
                    menu.style.display = 'none'; // Ensure it's hidden initially for click
                     newLink.addEventListener("click", function(e) {
                        if (categoryLinksUl.classList.contains("active")) { // Only if main mobile menu is active
                            e.preventDefault(); e.stopPropagation();
                            const isOpen = dropdown.classList.toggle("open");
                            menu.style.display = isOpen ? "block" : "none";
                        }
                    });
                }
            }
        });
    }
    window.addEventListener('resize', handleResize);

    // Search functionality
    const desktopSearchForm = document.getElementById('desktopSearchForm');
    const inlineMobileSearchForm = document.getElementById('inlineMobileSearchForm');

    function handleSearch(event) {
        event.preventDefault();
        const searchInput = event.currentTarget.querySelector('input[name="s"]');
        const searchTerm = searchInput.value.toLowerCase().trim();

        // Update category title to reflect search
        currentCategoryTitleEl.textContent = `Search Results for: "${searchTerm}"`;
        // Deactivate category links
        document.querySelectorAll('#categoryLinks a[data-category]').forEach(link => link.classList.remove('active-category-link'));
        const homeLink = document.querySelector('#categoryLinks a[data-category="All"]');
        if (homeLink && !searchTerm) { // If search is cleared, go back to "All Movies"
            homeLink.classList.add('active-category-link');
            currentCategoryTitleEl.textContent = 'All Movies';
        }

        // Filter movies based on search term
        if (!searchTerm) { currentFilteredMovies = [...allMoviesData]; } // If search is empty, show all
        else { currentFilteredMovies = allMoviesData.filter(movie => movie.data.name && movie.data.name.toLowerCase().includes(searchTerm));}
        renderMovies(1); // Render first page of search results

        // Close mobile menu if it was open during search
        if (categoryLinksUl.classList.contains("active")) {
             categoryLinksUl.classList.remove("active");
             document.body.classList.remove("category-menu-open");
        }
    }
    if(desktopSearchForm) desktopSearchForm.addEventListener('submit', handleSearch);
    if(inlineMobileSearchForm) inlineMobileSearchForm.addEventListener('submit', handleSearch);

    // Initial setup calls
    setCurrentFooterYear();
    loadAllMovies();
    handleResize(); // Call once on load to set initial state based on window size
  </script>
</body>
</html>
